<!DOCTYPE html>
<html>
<head>
	<meta charset="UTF-8">
	<title>Find User</title>
	<script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.3/jquery.min.js" type="text/javascript"></script>
	<style type="text/css">
		body {
			background-color: gray;
			align-items: center;		
		}
		
		button  {
			margin-bottom: 20px;		
			border-radius: 10px;		
		}	
		
		button a {
			position: relative;
			text-decoration: none;		
			color: black;
		}
		
		#page {
			margin: auto;
			background-color: white;
			box-shadow: 10px 10px 10px 10px black;
			border: 2px black solid;
			border-radius: 10px;
			text-align: center;
			width: 70%;
			height: 100%;
		}
		
	</style>
</head>
<body>
	<div id="page">
		<h1>Delete User</h1>				
		<p>
			<label for="user_cpf">CPF:</label>
			<input type="text" id="user_cpf" name="user_cpf" placeholder="123.456.789-11"
				onchange="maskCPF(this)">
		</p>			
		<button>
			<a href="/MVC_WEB/home.html"> Cancel </a>
		</button>
		<button id="delete" onclick="deleteUser()">Delete</button>		
	</div>	
</body>
<script type="text/javascript">
function maskCPF(element){
	var value = "";
	var cpf = element.value.replaceAll(".","").replaceAll("-","");		
	for(i = 0; i < cpf.length; i++){
		if(i == 3) value += cpf.substr(0, 3) + "." + cpf.substr(i, 1);
		else if(i == 6) value +=  cpf.substr(4, 2) + "." + cpf.substr(i, 1);
		else if(i == 9) value +=  cpf.substr(7, 2) + "-" + cpf.substr(i, 2);			
	}
	element.value = value;
}

function deleteUser(){
	var del = confirm("User will be deleted, continue?");
	
	if(!del) return;	
	
	var data = {
		"user_cpf": document.getElementById("user_cpf").value
	};
	
	var route = "/MVC_WEB/UserAPI";
	
	$.ajax({
		url: route, 
		headers: {"Content-Type":"application/json", "charset":"UTF-8"}, 
		method: "DELETE", data: data,
		statusCode: {
			204: function(response){
				alert("User has been deleted - CPF: " + data.user_cpf);
			},
			409: function(response){				
				alert("409 - " + response.responseJSON.Error);
			},
			404: function(response){
				alert("User not found - CPF: " + data.user_cpf);
			}			
		}});	
}
</script>
</html>